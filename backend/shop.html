<!-- backend/shop.html | Platzhalter + UP-Impuls (zurück zum Head)
     Erwartet: window.goHead() existiert in index.html
-->

<section class="shop" aria-label="Shop">
  <div class="shop-scroll" id="shopScroll" aria-label="Shop Scrollbereich">
    <div class="shop-inner">
      <h1 class="shop-title">Hier entsteht der Shop</h1>
      <p class="shop-sub">Produkte, Kategorien und Buchung folgen hier in Kürze.</p>

      <div class="shop-card">
        <div class="shop-card__title">Scroll-Test</div>
        <div class="shop-card__text">
          Scrolle nach unten – und wieder ganz nach oben.<br><br>
          <b>Up-Impuls:</b> Wenn du ganz oben bist und weiter nach oben scrollst, wird <code>window.goHead()</code> ausgelöst.
        </div>
      </div>

      <div class="shop-spacer" aria-hidden="true"></div>
    </div>
  </div>
</section>

<style>
  .shop{
    width:100%;
    height:100%;
    background:#ffffff;
  }

  .shop-scroll{
    width:100%;
    height:100%;
    overflow-y:auto;
    overflow-x:hidden;
    overscroll-behavior: contain;
    -webkit-overflow-scrolling: touch;
    padding: 56px 24px 80px;
  }
  .shop-scroll{ scrollbar-width:none; }
  .shop-scroll::-webkit-scrollbar{ width:0; height:0; }

  .shop-inner{
    max-width: 980px;
    margin: 0 auto;
  }

  .shop-title{
    margin:0 0 10px 0;
    font-size: clamp(28px, 3.2vw, 44px);
    letter-spacing:-0.02em;
    color:#0f172a;
  }

  .shop-sub{
    margin:0 0 26px 0;
    color: rgba(15,23,42,0.70);
    font-size: 16px;
    line-height:1.5;
  }

  .shop-card{
    background: #f8f9fb;
    border: 1px solid rgba(15,23,42,0.10);
    border-radius: 18px;
    padding: 18px 18px 16px;
  }

  .shop-card__title{
    font-weight: 900;
    color:#0f172a;
    margin-bottom: 8px;
  }

  .shop-card__text{
    color: rgba(15,23,42,0.78);
    line-height:1.6;
  }

  .shop-spacer{
    height: 120vh;
  }

  code{
    background: rgba(15,23,42,0.06);
    padding: 2px 6px;
    border-radius: 8px;
  }
</style>

<script>
  (function(){
    const el = document.getElementById("shopScroll");
    if(!el) return;

    let upArmed = false;
    let cooldown = false;

    const atTop = () => el.scrollTop <= 1;
    const triggerUp = () => {
      if (cooldown) return;
      cooldown = true;
      if (typeof window.goHead === "function") window.goHead();
      setTimeout(() => (cooldown = false), 500);
    };

    el.addEventListener("scroll", () => {
      if (!atTop()) upArmed = false;
    }, { passive:true });

    el.addEventListener("wheel", (e) => {
      const up = e.deltaY < 0;
      if(!up) return;

      if (atTop()){
        if (upArmed){
          e.preventDefault();
          triggerUp();
        } else {
          upArmed = true; // erster Impuls: arming
        }
      }
    }, { passive:false });

    // Touch (iOS/Android): overscroll oben -> Up auslösen
    let lastY = null;
    el.addEventListener("touchstart", (e) => {
      lastY = e.touches && e.touches[0] ? e.touches[0].clientY : null;
    }, { passive:true });

    el.addEventListener("touchmove", (e) => {
      if (lastY == null) return;
      const y = e.touches && e.touches[0] ? e.touches[0].clientY : null;
      if (y == null) return;
      const dy = y - lastY; // dy > 0 = Finger nach unten => scroll nach oben
      if (dy > 8 && atTop()){
        // "weiter nach oben" (Overscroll)
        e.preventDefault();
        triggerUp();
        lastY = y;
      } else {
        lastY = y;
      }
    }, { passive:false });
  })();
</script>
