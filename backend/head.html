<!-- backend/head.html -->
<style>
  :root{
    /* kommt aus index.html / titel.html, hier als Fallback falls nicht gesetzt */
    --title-pad-x: 72px;
    --title-height: 70px;

    --radius: 18px;
    --shadow-soft: 0 12px 34px rgba(0,0,0,.14);
  }

  /* Gesamtbereich unter dem sticky Titel */
  .head-wrap{
    padding-top: var(--title-pad-x);         /* oben = wie Titel-Padding */
    padding-left: var(--title-pad-x);        /* links = wie Titel-Padding */
    padding-right: var(--title-pad-x);       /* rechts = wie Titel-Padding */
    padding-bottom: var(--title-pad-x);      /* unten = wie Titel-Padding */
    width: 100%;
  }

  /* Mittiger „Hero“-Container */
  .hero{
    max-width: 1200px;
    margin: 0 auto;
    border-radius: var(--radius);
    overflow: hidden;
    box-shadow: var(--shadow-soft);
    position: relative;
    min-height: 55vh; /* großer Bildbereich */
    background: #e9eef6;
  }

  .hero__bg{
    position:absolute;
    inset:0;
    background-position:center;
    background-size: cover;
    transform: scale(1.02);
  }

  /* Abdunklung */
  .hero__dim{
    position:absolute;
    inset:0;
    background: rgba(0,0,0,.35);
  }

  /* optionaler Inhalt oben drauf (aktuell leer, aber vorbereitet) */
  .hero__content{
    position:relative;
    z-index:2;
    height:100%;
    display:flex;
    align-items:flex-end;
    padding: 22px;
    color:#fff;
  }

  /* Zweiter Container: 1/4 Bildschirmhöhe */
  .items-strip{
    max-width: 1200px;
    margin: 18px auto 0 auto;
    height: 25vh;
    min-height: 180px;

    border-radius: var(--radius);
    overflow: hidden;
    box-shadow: var(--shadow-soft);
    background:#fff;
  }

  .items-strip__inner{
    height: 100%;
    display:flex;
    align-items:center;
    gap: 14px;
    padding: 14px;
    overflow-x:auto;
    overflow-y:hidden;
    scroll-behavior:smooth;
  }

  .item-thumb{
    flex: 0 0 auto;
    height: calc(25vh - 28px);
    max-height: 180px;
    aspect-ratio: 1 / 1;
    border-radius: 14px;
    overflow:hidden;
    background:#f3f5f8;
    box-shadow: 0 6px 18px rgba(0,0,0,.10);
  }

  .item-thumb img{
    width:100%;
    height:100%;
    object-fit: cover;
    display:block;
  }

  @media (max-width: 900px){
    :root{ --title-pad-x: 40px; }
    .hero{ min-height: 48vh; }
  }

  @media (max-width: 560px){
    :root{ --title-pad-x: 22px; }
    .items-strip{ min-height: 160px; }
    .item-thumb{ max-height: 160px; }
  }
</style>

<section class="head-wrap" aria-label="Header-Bereich">
  <!-- großes Zufallsbild -->
  <div class="hero" id="hero">
    <div class="hero__bg" id="heroBg"></div>
    <div class="hero__dim"></div>
    <div class="hero__content">
      <!-- bewusst leer: nur Bild/Look -->
    </div>
  </div>

  <!-- darunter: Reihe Zufalls-Itembilder -->
  <div class="items-strip" id="itemsStrip">
    <div class="items-strip__inner" id="itemsRow"></div>
  </div>
</section>

<script>
(function(){
  // Erwartet diese Dateien (bitte anlegen):
  // 1) image/hintergrund/manifest.json  -> ["bild1.jpg","bild2.png",...]
  // 2) Items/manifest.json              -> ["Items/OrdnerA/img1.jpg","Items/OrdnerB/img2.png",...]
  //
  // Vorteil: funktioniert auf GitHub Pages ohne Directory-Listing.

  async function loadManifest(path){
    const res = await fetch(path, { cache: "no-store" });
    if(!res.ok) throw new Error(path + " -> " + res.status);
    const data = await res.json();
    if(!Array.isArray(data)) throw new Error(path + " ist kein Array");
    return data;
  }

  function pickRandom(arr){
    return arr[Math.floor(Math.random() * arr.length)];
  }

  function shuffle(arr){
    const a = arr.slice();
    for(let i=a.length-1;i>0;i--){
      const j = Math.floor(Math.random() * (i+1));
      [a[i], a[j]] = [a[j], a[i]];
    }
    return a;
  }

  async function setRandomHero(){
    const bgEl = document.getElementById("heroBg");
    if(!bgEl) return;

    const files = await loadManifest("image/hintergrund/manifest.json");
    if(!files.length) return;

    const file = pickRandom(files);
    bgEl.style.backgroundImage = "url('" + "image/hintergrund/" + file + "')";
  }

  async function renderItemRow(){
    const row = document.getElementById("itemsRow");
    if(!row) return;

    const files = await loadManifest("Items/manifest.json");
    if(!files.length) return;

    const picks = shuffle(files).slice(0, 12); // Anzahl Bilder in der Reihe
    row.innerHTML = "";

    for(const src of picks){
      const wrap = document.createElement("div");
      wrap.className = "item-thumb";

      const img = document.createElement("img");
      img.loading = "lazy";
      img.alt = "";
      img.src = src;

      wrap.appendChild(img);
      row.appendChild(wrap);
    }
  }

  (async function(){
    try{
      await Promise.all([setRandomHero(), renderItemRow()]);
    }catch(e){
      console.error("head.html:", e);
    }
  })();
})();
</script>
