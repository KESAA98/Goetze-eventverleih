<!-- backend/head.html (modern v3) -->
<style>
  :root{
    --lg-radius: 22px;
    --lg-shadow: 0 18px 50px rgba(0,0,0,.14);
    --lg-shadow-soft: 0 10px 28px rgba(0,0,0,.10);
    --lg-border: rgba(0,0,0,.08);
    --lg-text: #0f172a;
    --lg-muted: rgba(15, 23, 42, .68);
    --lg-chip: rgba(255,255,255,.82);
  }

  /* keep everything scoped */
  .lg-head-wrap{ width:100%; }
  .lg-hero{
    width:100%;
    height:52vh;
    min-height:380px;
    max-height:680px;
    border-radius: var(--lg-radius);
    overflow:hidden;
    position:relative;
    box-shadow: var(--lg-shadow);
    background: #e9edf4;
  }

  .lg-hero .bg{
    position:absolute; inset:0;
    background-size: cover;
    background-position:center;
    transform: scale(1.02);
    filter: saturate(1.02) contrast(1.02);
  }
  .lg-hero .veil{
    position:absolute; inset:0;
    background:
      radial-gradient(900px 540px at 18% 70%, rgba(255,255,255,.84) 0%, rgba(255,255,255,.56) 46%, rgba(255,255,255,0) 72%),
      linear-gradient(90deg, rgba(255,255,255,.75) 0%, rgba(255,255,255,.25) 46%, rgba(255,255,255,0) 70%),
      linear-gradient(180deg, rgba(0,0,0,.22) 0%, rgba(0,0,0,0) 34%, rgba(0,0,0,.30) 100%);
    pointer-events:none;
  }

  .lg-hero .inner{
    position:relative;
    height:100%;
    display:grid;
    grid-template-columns: 1.1fr .9fr;
    gap: 26px;
    padding: 34px 34px 90px 34px;
    align-items:center;
  }

  @media (max-width: 980px){
    .lg-hero{ height:auto; min-height:0; }
    .lg-hero .inner{
      grid-template-columns: 1fr;
      padding: 26px 22px 110px 22px;
      align-items:start;
    }
  }

  .lg-badge{
    display:inline-flex;
    align-items:center;
    gap:10px;
    padding: 9px 12px;
    border-radius: 999px;
    background: var(--lg-chip);
    border: 1px solid rgba(255,255,255,.7);
    box-shadow: var(--lg-shadow-soft);
    backdrop-filter: blur(10px);
    width: fit-content;
    color: var(--lg-text);
    font-weight: 600;
    letter-spacing:.2px;
  }
  .lg-dot{
    width:10px; height:10px; border-radius:50%;
    background:#22c55e;
    box-shadow: 0 0 0 3px rgba(34,197,94,.18);
  }

  .lg-title{
    margin: 16px 0 10px;
    font-size: clamp(34px, 4.2vw, 56px);
    line-height: 1.04;
    letter-spacing: -0.02em;
    color: var(--lg-text);
    font-weight: 800;
  }

  .lg-sub{
    margin: 0 0 18px;
    color: var(--lg-muted);
    font-size: 16px;
    max-width: 46ch;
  }

  .lg-actions{
    display:flex;
    gap:10px;
    align-items:center;
    flex-wrap:wrap;
    margin-top: 18px;
  }
  .lg-btn{
    appearance:none;
    border:0;
    cursor:pointer;
    display:inline-flex;
    align-items:center;
    gap:10px;
    padding: 12px 16px;
    border-radius: 999px;
    font-weight: 700;
    letter-spacing:.2px;
    box-shadow: var(--lg-shadow-soft);
    transition: transform .15s ease, filter .15s ease;
  }
  .lg-btn:active{ transform: translateY(1px); }
  .lg-btn.primary{
    background:#0f172a;
    color:#fff;
  }
  .lg-btn.ghost{
    background: rgba(255,255,255,.80);
    color: var(--lg-text);
    border: 1px solid rgba(255,255,255,.70);
    backdrop-filter: blur(10px);
  }

  /* Product mini strip (subtle) */
  .lg-inspo{
    justify-self:end;
    width:min(460px, 100%);
    border-radius: 18px;
    background: rgba(255,255,255,.72);
    border: 1px solid rgba(255,255,255,.72);
    backdrop-filter: blur(12px);
    box-shadow: var(--lg-shadow-soft);
    padding: 14px 14px 12px;
  }
  @media (max-width: 980px){
    .lg-inspo{ justify-self:stretch; }
  }

  .lg-inspo-top{
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:12px;
    margin-bottom: 10px;
    color: var(--lg-text);
    font-weight: 800;
  }
  .lg-inspo-top small{
    font-weight:700;
    color: rgba(15,23,42,.55);
  }
  .lg-inspo-grid{
    display:grid;
    grid-template-columns: repeat(5, 1fr);
    gap:10px;
  }
  .lg-thumb{
    aspect-ratio: 1 / 1;
    border-radius: 14px;
    overflow:hidden;
    border: 1px solid var(--lg-border);
    background: #eef2f7;
  }
  .lg-thumb img{
    width:100%; height:100%;
    object-fit:cover;
    display:block;
  }
  @media (max-width: 520px){
    .lg-inspo-grid{ grid-template-columns: repeat(4, 1fr); }
    .lg-thumb:nth-child(5){ display:none; }
  }

  /* Team strip IN the hero (overlay bottom) */
  .lg-teambar{
    position:absolute;
    left: 22px;
    right: 22px;
    bottom: 18px;
    border-radius: 18px;
    padding: 14px 14px 12px;
    background: rgba(255,255,255,.78);
    border: 1px solid rgba(255,255,255,.78);
    backdrop-filter: blur(14px);
    box-shadow: var(--lg-shadow-soft);
  }
  .lg-teambar-head{
    display:flex;
    justify-content:space-between;
    align-items:flex-end;
    gap:12px;
    margin-bottom: 10px;
  }
  .lg-teambar-title{
    display:flex;
    align-items:center;
    gap:10px;
    color: var(--lg-text);
    font-weight: 900;
    letter-spacing: .2px;
  }
  .lg-teambar-sub{
    color: rgba(15,23,42,.58);
    font-weight:700;
    font-size: 12.5px;
  }

  .lg-teamrow{
    display:flex;
    gap: 12px;
    overflow:auto;
    padding-bottom: 6px;
    scroll-snap-type: x mandatory;
  }
  .lg-teamrow::-webkit-scrollbar{ height: 10px; }
  .lg-teamrow::-webkit-scrollbar-thumb{
    background: rgba(15,23,42,.15);
    border-radius: 999px;
  }

  .lg-member{
    min-width: 260px;
    max-width: 320px;
    flex: 0 0 auto;
    display:flex;
    gap: 12px;
    align-items:flex-start;
    padding: 10px 12px;
    border-radius: 16px;
    background: rgba(255,255,255,.92);
    border: 1px solid rgba(15,23,42,.08);
    scroll-snap-align: start;
  }
  .lg-avatar{
    width: 56px;
    height: 56px;
    border-radius: 16px;
    overflow:hidden;
    background:#e9eef6;
    border: 1px solid rgba(15,23,42,.10);
    flex: 0 0 auto;
  }
  .lg-avatar img{ width:100%; height:100%; object-fit:cover; display:block; }
  .lg-mtext{ min-width:0; }
  .lg-mtop{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:10px;
    margin-top: 2px;
    margin-bottom: 2px;
  }
  .lg-mname{
    font-weight: 900;
    color: var(--lg-text);
    font-size: 14.5px;
    white-space:nowrap;
    overflow:hidden;
    text-overflow:ellipsis;
    max-width: 170px;
  }
  .lg-mpos{
    font-weight: 900;
    font-size: 12px;
    color: rgba(15,23,42,.60);
    background: rgba(15,23,42,.06);
    border: 1px solid rgba(15,23,42,.08);
    padding: 4px 8px;
    border-radius: 999px;
    flex:0 0 auto;
  }
  .lg-mbio{
    color: rgba(15,23,42,.70);
    font-size: 12.5px;
    line-height: 1.25;
    display:-webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow:hidden;
  }
</style>

<div class="lg-head-wrap">
  <section class="lg-hero" id="lgHero">
    <div class="bg" id="lgHeroBg"></div>
    <div class="veil"></div>

    <div class="inner">
      <div class="copy">
        <div class="lg-badge"><span class="lg-dot"></span> LG Eventverleih</div>
        <h1 class="lg-title">Feiern leicht gemacht.</h1>
        <p class="lg-sub">Stilvolle Ausstattung, saubere Abwicklung und zuverlässiger Aufbau – damit du dich um das Wichtigste kümmern kannst.</p>

        <div class="lg-actions">
          <button class="lg-btn primary" type="button" data-scroll="shop">Zum Shop</button>
          <button class="lg-btn ghost" type="button" id="lgShuffle">Neu mischen</button>
        </div>
      </div>

      <aside class="lg-inspo" aria-label="Inspiration">
        <div class="lg-inspo-top">
          <div>Inspiration <small>(Zufall)</small></div>
          <small id="lgInspoInfo">Artikel</small>
        </div>
        <div class="lg-inspo-grid" id="lgInspoGrid">
          <!-- thumbs -->
        </div>
      </aside>
    </div>

    <div class="lg-teambar" aria-label="Team">
      <div class="lg-teambar-head">
        <div class="lg-teambar-title">Unser Team</div>
        <div class="lg-teambar-sub">Planung · Aufbau · Service</div>
      </div>
      <div class="lg-teamrow" id="lgTeamRow">
        <div style="color:rgba(15,23,42,.65); font-weight:700; font-size:13px; padding:6px 2px;">
          Team wird geladen…
        </div>
      </div>
    </div>
  </section>
</div>

<script>
(() => {
  const $ = (s, r=document) => r.querySelector(s);

  const BG_MANIFEST = "image/hintergrund/manifest.json";
  const ITEM_MANIFEST = "Items/manifest.json";
  const TEAM_MANIFEST = "Team/manifest.json";

  const heroBg = $("#lgHeroBg");
  const inspoGrid = $("#lgInspoGrid");
  const inspoInfo = $("#lgInspoInfo");
  const teamRow = $("#lgTeamRow");
  const shuffleBtn = $("#lgShuffle");

  function pickRandom(arr, n){
    const a = (arr||[]).slice();
    for(let i=a.length-1;i>0;i--){
      const j = Math.floor(Math.random()*(i+1));
      [a[i], a[j]] = [a[j], a[i]];
    }
    return a.slice(0, n);
  }

  async function fetchJson(url){
    const res = await fetch(url, { cache: "no-store" });
    if(!res.ok) throw new Error("fetch failed: " + url + " " + res.status);
    return await res.json();
  }

  async function tryImage(url){
    try{
      const res = await fetch(url, { method:"GET", cache:"no-store" });
      return res.ok ? url : null;
    }catch(e){ return null; }
  }

  function parseNameAndPos(folder, fallbackPos){
    // "Lisa_2" -> name "Lisa", pos 2
    const m = String(folder||"").match(/^(.*?)[_-](\d+)$/);
    if(m){
      return { name: (m[1]||"Team").replace(/[_-]+/g," ").trim(), pos: Number(m[2]) };
    }
    return { name: String(folder||"Team").replace(/[_-]+/g," ").trim(), pos: fallbackPos };
  }

  async function loadBackground(){
    const list = await fetchJson(BG_MANIFEST);
    if(!Array.isArray(list) || list.length === 0) return;
    const file = list[Math.floor(Math.random() * list.length)];
    const url = `image/hintergrund/${file}`;
    heroBg.style.backgroundImage = `url("${url}")`;
  }

  async function loadInspo(){
    inspoGrid.innerHTML = "";
    let list = [];
    try{ list = await fetchJson(ITEM_MANIFEST); } catch(e){ list = []; }
    const picks = pickRandom(Array.isArray(list) ? list : [], 5);

    if(picks.length === 0){
      inspoInfo.textContent = "Keine Bilder";
      return;
    }
    inspoInfo.textContent = `${picks.length} Artikel`;

    for(const p of picks){
      const wrap = document.createElement("div");
      wrap.className = "lg-thumb";
      const img = document.createElement("img");
      img.loading = "lazy";
      img.alt = "Artikel";
      img.src = p;
      wrap.appendChild(img);
      inspoGrid.appendChild(wrap);
    }
  }

  async function loadTeam(){
    teamRow.innerHTML = "";
    let data;
    try{
      data = await fetchJson(TEAM_MANIFEST);
    }catch(e){
      teamRow.innerHTML = `<div style="color:rgba(15,23,42,.65); font-weight:700; font-size:13px; padding:6px 2px;">
        Team konnte nicht geladen werden.
      </div>`;
      return;
    }

    const members = (data && data.members) ? data.members : [];
    if(!Array.isArray(members) || members.length === 0){
      teamRow.innerHTML = `<div style="color:rgba(15,23,42,.65); font-weight:700; font-size:13px; padding:6px 2px;">
        Noch kein Team hinterlegt.
      </div>`;
      return;
    }

    for(let i=0;i<members.length;i++){
      const folder = members[i]?.folder;
      const meta = parseNameAndPos(folder, i+1);

      // image candidates (your example uses image.png)
      const base = `Team/${folder}/`;
      const candidates = [
        "image.png","image.jpg","image.jpeg","image.webp",
        "profil.png","profil.jpg","profil.jpeg","profil.webp",
        "profile.png","profile.jpg","profile.jpeg","profile.webp",
        "portrait.png","portrait.jpg","portrait.jpeg","portrait.webp"
      ];

      let imgUrl = null;
      for(const c of candidates){
        const ok = await tryImage(base + c);
        if(ok){ imgUrl = ok; break; }
      }

      let bio = "";
      try{
        const res = await fetch(base + "team.txt", { cache:"no-store" });
        if(res.ok) bio = (await res.text()).trim();
      }catch(e){ bio = ""; }

      const card = document.createElement("div");
      card.className = "lg-member";

      const av = document.createElement("div");
      av.className = "lg-avatar";
      if(imgUrl){
        const im = document.createElement("img");
        im.loading = "lazy";
        im.alt = meta.name;
        im.src = imgUrl;
        av.appendChild(im);
      }
      card.appendChild(av);

      const t = document.createElement("div");
      t.className = "lg-mtext";

      const top = document.createElement("div");
      top.className = "lg-mtop";

      const nm = document.createElement("div");
      nm.className = "lg-mname";
      nm.textContent = meta.name || `Teammitglied`;

      const ps = document.createElement("div");
      ps.className = "lg-mpos";
      ps.textContent = `#${meta.pos}`;

      top.appendChild(nm);
      top.appendChild(ps);

      const bi = document.createElement("div");
      bi.className = "lg-mbio";
      bi.textContent = bio || "—";

      t.appendChild(top);
      t.appendChild(bi);

      card.appendChild(t);
      teamRow.appendChild(card);
    }
  }

  async function shuffleAll(){
    await Promise.allSettled([loadBackground(), loadInspo(), loadTeam()]);
  }

  // make buttons work with the existing index scroll handler (data-scroll)
  shuffleBtn?.addEventListener("click", () => shuffleAll());

  shuffleAll();
})();
</script>
